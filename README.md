# CAFPE
[![Build Status](http://ftae31.ugr.es:8090/buildStatus/icon?job=cafpe)](http://ftae31.ugr.es:8090/job/cafpe/)

## Needed software for development

  - [Git](https://git-scm.com/): Version control
  - [Composer](https://getcomposer.org/): PHP Package installer
  - [PHPUnit]
  - [Node and npm](https://nodejs.org/) and [Gulp](http://gulpjs.com/): Build assets and some development features

## Set up
Follow each section below and run the commands.

### Shared hooks
After cloning the repository, cd into it and run:

```
$ make init
```

This sets the common git configuration values that all contributors should have in their ```.git/config``` file. More specifically, those that enable the use of shared hooks which are located in the ```.githooks``` folder.

Since git version 2.9 the default hooks folder location can be changed using ```core.hookspath```, allowing to share them among all contributors, and thus keeping commits more stadard.

The only hook configured so far (pre-commit) regenerates documentation using [apiGen](https://github.com/apigen/apigen) before pushing. This PHP package is installed in the next section.

### PHP Packages
To install the required PHP packages:

```
$ composer install
```

Run install script for CodeIgniter PHPUnit tests integration:
```
$ php vendor/kenjis/ci-phpunit-test/install.php
```

After that edit ```application/tests/Bootstrap.php``` and remove comments in Monkey Patching section.

### Assets generation via Gulp
The gulpfile included in the repository is the same one used for deploying the app used by ```deploy.bash```. It contains the tasks to get the final assets used in production, but also there is a task used for development, which includes some nice features like browser reloading when code or source assets are changed.

To use it, first install Node and npm in your system. Then cd into the repo and run:

```
$ npm install
$ gulp dev
```

## Tests

To run tests:

```
$ vendor/bin/phpunit -c application/tests
```

## Updating

```
$ composer update
```

Files should be updated manually if files in `application` folder or `index.php` change. Check [CodeIgniter User Guide](http://www.codeigniter.com/user_guide/installation/upgrading.html)

## Documentation
Chech the ApiGen autogenerated documentation [here](https://pizzicato.github.io/CAFPE/). As described above, it's regenerated automatically before every commit.
