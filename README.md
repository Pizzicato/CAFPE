# CAFPE
[![Build Status](http://ftae31.ugr.es:8090/buildStatus/icon?job=cafpe)](http://ftae31.ugr.es:8090/job/cafpe/)

## Needed software for development

  - [Git](https://git-scm.com/): Version control
  - [PHP](http://php.net/)
  - [Composer](https://getcomposer.org/): PHP Package installer
  - [Node and npm](https://nodejs.org/): Build assets and some development features

## Set up
Follow each section below and run the commands.

### Shared hooks
After cloning the repository, cd into it and run:

```
$ make init
```

This sets the common git configuration values that all contributors should have in their ```.git/config``` file. More specifically, those that enable the use of shared hooks which are located in the ```.githooks``` folder.

Since git version 2.9 the default hooks folder location can be changed using ```core.hookspath```, allowing to share them among all contributors, and thus keeping commits more stadard.

The only hook configured so far (pre-commit) regenerates documentation using [apiGen](https://github.com/apigen/apigen) before pushing. This PHP package is installed in the next section.

### PHP Packages
To install the required PHP packages:

```
$ composer install
```

### Assets generation and development utilities
Node and npm are used for this purpose. To install all needed modules:
```
$ npm install
```

The package.json file npm scripts are the same ones used for deploying the app run by ```deploy.bash```.

It contains two main scripts:

Final assets creation from sources (SCSS, javascripts, images and fonts)
```
$ npm run build
```
Automatic browse reload when assets change and automatic rebuild of assets if sources are changed:
```
$ npm run watch
```

## Tests

To run tests:

```
$ vendor/bin/phpunit -c application/tests
```

## Updating

```
$ composer update
```

Since 'kenjis/ci-phpunit-test' and 'kenjis/codeigniter-cli' packages use install scripts to copy files from ```vendor/``` to ```application/```, in case they are updated, they might have to be run again.

If there is a new CodeIgniter package release, before pushing changes to repo, check if dependent packages have been updated accordingly.

## Documentation
Chech the ApiGen autogenerated documentation [here](https://pizzicato.github.io/CAFPE/). As described above, it's regenerated automatically before every commit.
